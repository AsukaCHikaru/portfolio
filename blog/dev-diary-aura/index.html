<!DOCTYPE html><html lang="en"><head>
    <script type="module" src="/index.js" async=""></script>
    <link rel="stylesheet" href="/subfont/fonts-7bb5cf3231.css">
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/modern-normalize.css">
    
    
    
    
    
    <link rel="preload" href="/fonts/subset_extended_latin_GentiumBookPlus_Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    
  </head>
  <body>
    <div id="root"><div><div class="site_container"><nav class="site-header_grid-wrapper"><div class="site-header_container"><div><a href="/blog">blog</a><a href="/about">about</a></div><a href="/">ASUKA WANG</a></div><div class="site-header_divider" role="presentation"></div></nav><main><div class="post-page-header_container"><h1>Dev Diary: Aura</h1><h2>我嘗試了自己設計並實裝靈氣系統。它也許不顯眼，但絕不簡單。</h2><p>2018-05-28</p></div><article><p>在最近進行的 side project 中刻了一個靈氣(aura)輪子。比我想像中的麻煩，決定動筆記錄一下。</p><p>首先，這是個規模很小的回合制遊戲，所有角色算攻防加權的動作可以塞在一個迴圈裡面。概念很簡單，我打算先算加權，然後再用加權套進攻防公式，而靈氣的部分就塞在加權裡一起處理。</p><p>這裡出現了第一個問題：回到剛剛說的「一個迴圈算完所有數字」，這導致了有些人的靈氣被套進加權時，應該被影響的對象已經先算完了。我也不想算每個人的攻防時再去抓一次所有角色所持有靈氣的判斷，效率感覺就很差。</p><p>所以我在每次行動決定後攻防開始前，先把靈氣註冊到該陣營的資料裡，如此就不用多從所有角色撈一次靈氣的資料，所有人都可以到固定的地方找靈氣。</p><p>就這樣很開心地開始跑了之後出現了第二個問題：由於系統設計上所有角色的加權都可能互相影響，每次算加權都會對每個角色計算一次。幾個角色行動就算幾次。所以靈氣的效果就被乘以人數。</p><p>我的解法是當靈氣啟動時算一次受影響目標，連帶的加權也在那時候就算完。靈氣的啟動與否會有很明顯的斷點(每次攻防結束都會斷掉，效果就被收回。開始時再啟動，這時再把效果加回去)。而原本的加權計算部分，從只計算靈氣的效果加上啟動與否的判斷。</p><p>就遊戲設計上來說靈氣是一個不好處理的東西。持續性的效果代表特效不會比一次性的技能顯目，但如此往往讓玩家低估了他實際的效果，同時設計者與玩家之間對靈氣在 lore 所扮演角色的沉浸感也常常有所歧異。</p><p>簡單地說，如果不是很花巧思的靈氣，你往往會覺得他很無聊。但這樣無聊的東西事實上花了比我想像還多的功夫，僅此紀錄一筆。</p><p>至於我把靈氣寫完之後發現太強所以拔掉就又是另一個故事了。</p></article></main><footer class="site-footer_container">Asuka Wang © <!-- -->2025</footer></div></div></div><script>window.__STATIC_PROPS__ = {"blog":{"post":{"metadata":{"title":"Dev Diary: Aura","description":"我嘗試了自己設計並實裝靈氣系統。它也許不顯眼，但絕不簡單。","publishedAt":"2018-05-28","pathname":"dev-diary-aura","category":"retrospective","topic":"game development","language":"zh-TW","featured":false},"content":[{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"在最近進行的 side project 中刻了一個靈氣(aura)輪子。比我想像中的麻煩，決定動筆記錄一下。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"首先，這是個規模很小的回合制遊戲，所有角色算攻防加權的動作可以塞在一個迴圈裡面。概念很簡單，我打算先算加權，然後再用加權套進攻防公式，而靈氣的部分就塞在加權裡一起處理。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"這裡出現了第一個問題：回到剛剛說的「一個迴圈算完所有數字」，這導致了有些人的靈氣被套進加權時，應該被影響的對象已經先算完了。我也不想算每個人的攻防時再去抓一次所有角色所持有靈氣的判斷，效率感覺就很差。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"所以我在每次行動決定後攻防開始前，先把靈氣註冊到該陣營的資料裡，如此就不用多從所有角色撈一次靈氣的資料，所有人都可以到固定的地方找靈氣。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"就這樣很開心地開始跑了之後出現了第二個問題：由於系統設計上所有角色的加權都可能互相影響，每次算加權都會對每個角色計算一次。幾個角色行動就算幾次。所以靈氣的效果就被乘以人數。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"我的解法是當靈氣啟動時算一次受影響目標，連帶的加權也在那時候就算完。靈氣的啟動與否會有很明顯的斷點(每次攻防結束都會斷掉，效果就被收回。開始時再啟動，這時再把效果加回去)。而原本的加權計算部分，從只計算靈氣的效果加上啟動與否的判斷。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"就遊戲設計上來說靈氣是一個不好處理的東西。持續性的效果代表特效不會比一次性的技能顯目，但如此往往讓玩家低估了他實際的效果，同時設計者與玩家之間對靈氣在 lore 所扮演角色的沉浸感也常常有所歧異。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"簡單地說，如果不是很花巧思的靈氣，你往往會覺得他很無聊。但這樣無聊的東西事實上花了比我想像還多的功夫，僅此紀錄一筆。"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"至於我把靈氣寫完之後發現太強所以拔掉就又是另一個故事了。"}]}]}}}</script>
  

<script>(function(){var el=document.createElement('link');el.href='/subfont/fallback-665d0ee727.css';el.rel='stylesheet';document.body.appendChild(el)}())</script><noscript><link rel="stylesheet" href="/subfont/fallback-665d0ee727.css"></noscript></body></html>