<!doctype html>
<html lang="en">
  <head>
    <title>Thoughts on Building a Game with XState | Asuka Wang</title>
    <meta name="description" content="After hearing about XState's good reputation for years, I used it to build the prototype for my game. These are my thoughts.">
    <meta name="author" content="Asuka Wang">
    <meta property="og:title" content="Thoughts on Building a Game with XState | Asuka Wang">
    <meta property="og:description" content="After hearing about XState's good reputation for years, I used it to build the prototype for my game. These are my thoughts.">
  
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="module" src="/index.js" async></script>
    <link rel="stylesheet" href="/fonts.css" />
    <link rel="stylesheet" href="/style.css" />
    <link rel="stylesheet" href="/modern-normalize.css" />
    <link
      rel="preload"
      href="/fonts/CormorantGaramond-Regular.subset.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_extended_latin_NotoSerifJP_Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_extended_latin_NotoSerifJP_ExtraLight.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_latin_NotoSerifJP_Bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_latin_NotoSans_ExtraLight.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_latin_NotoSans_Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_extended_latin_GentiumBookPlus_Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_extended_latin_GentiumBookPlus_Bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/fonts/subset_extended_latin_GentiumPlus_Italic.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div id="root"><div><div class="site_container grid"><header class="site-header"><div class="header-content"><div class="header_left_content"><nav><a href="/blog">blog</a><a href="/about">about</a><a href="/blog/feed.xml">rss</a></nav><button type="button" class="frontpage-header-menu-button">menu</button></div><h1><a href="/">ASUKA WANG</a></h1><div class="header_right_content"></div></div><div class="header-divider"></div></header><main class="grid"><div class="post-page-header_container"><h1>Thoughts on Building a Game with XState</h1><h2>After hearing about XState&#x27;s good reputation for years, I used it to build the prototype for my game. These are my thoughts.</h2><p>January 4, 2025</p></div><article class="post-page-content grid"><p>For the prototyping of <a href="https://grapegummygames.itch.io/project-fiddlesticks" target="_blank" rel="noopener noreferrer">Project Fiddlesticks</a>, my latest indie game project, I used <a href="https://react.dev" target="_blank" rel="noopener noreferrer">React</a> and <a href="https://xstate.js.org/" target="_blank" rel="noopener noreferrer">XState</a> as the building blocks. Finite state machines are essential components in games, and for a few years I have heard a lot of good things about XState as a finite state machine library; this is my first time using it, and it lived up to its reputation. After finishing the prototype, I decided to write up my thoughts on using XState in game development.</p><h1>Head first XState</h1><p>Below is an example of a basic state machine that represents the most basic behavior of a mob: it is <code>alive</code> by default, loses <code>hp</code> when taking <code>damage</code>, and enters <code>dead</code> state if hp drops to zero.</p><div><pre class="shiki gruvbox-light-soft" style="background-color:#f2e5bc;color:#3c3836" tabindex="0"><code><span class="line"><span style="color:#AF3A03">const</span><span style="color:#076678"> mobStateMachine</span><span style="color:#3C3836"> = setup({</span></span>
<span class="line"><span style="color:#B57614">  types</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#B57614">    context</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {}</span><span style="color:#9D0006"> as</span><span style="color:#7C6F64"> {</span><span style="color:#076678"> hp</span><span style="color:#427B58">:</span><span style="color:#B57614"> number</span><span style="color:#7C6F64">;</span><span style="color:#076678"> maxHp</span><span style="color:#427B58">:</span><span style="color:#B57614"> number </span><span style="color:#7C6F64">},</span></span>
<span class="line"><span style="color:#B57614">    input</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {}</span><span style="color:#9D0006"> as</span><span style="color:#7C6F64"> {</span><span style="color:#076678"> maxHp</span><span style="color:#427B58">:</span><span style="color:#B57614"> number </span><span style="color:#7C6F64">},</span></span>
<span class="line"><span style="color:#B57614">    events</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {}</span><span style="color:#9D0006"> as</span><span style="color:#7C6F64"> {</span><span style="color:#076678"> type</span><span style="color:#427B58">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">damage</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">;</span><span style="color:#076678"> damage</span><span style="color:#427B58">:</span><span style="color:#B57614"> number </span><span style="color:#7C6F64">},</span></span>
<span class="line"><span style="color:#7C6F64">  },</span></span>
<span class="line"><span style="color:#3C3836">})</span><span style="color:#7C6F64">.</span><span style="color:#B57614">createMachine</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">{</span></span>
<span class="line"><span style="color:#3C3836">  id</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mobState</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#3C3836">  initial</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">alive</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#B57614">  context</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> ({</span><span style="color:#076678"> input</span><span style="color:#7C6F64"> })</span><span style="color:#AF3A03"> =></span><span style="color:#3C3836"> (</span><span style="color:#7C6F64">{</span></span>
<span class="line"><span style="color:#3C3836">    hp</span><span style="color:#7C6F64">:</span><span style="color:#076678"> input</span><span style="color:#7C6F64">.</span><span style="color:#076678">maxHp</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#3C3836">    maxHp</span><span style="color:#7C6F64">:</span><span style="color:#076678"> input</span><span style="color:#7C6F64">.</span><span style="color:#076678">maxHp</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">  }</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#3C3836">  states</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">    alive</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">      on</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">        damage</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">          target</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">hit</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#3C3836">          actions</span><span style="color:#7C6F64">:</span><span style="color:#B57614"> assign</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">{</span></span>
<span class="line"><span style="color:#B57614">            hp</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> ({</span><span style="color:#076678"> context</span><span style="color:#7C6F64">,</span><span style="color:#076678"> event</span><span style="color:#7C6F64"> })</span><span style="color:#AF3A03"> =></span><span style="color:#076678"> Math</span><span style="color:#7C6F64">.</span><span style="color:#B57614">max</span><span style="color:#3C3836">(</span><span style="color:#076678">context</span><span style="color:#7C6F64">.</span><span style="color:#076678">hp</span><span style="color:#427B58"> -</span><span style="color:#076678"> event</span><span style="color:#7C6F64">.</span><span style="color:#076678">damage</span><span style="color:#7C6F64">,</span><span style="color:#8F3F71"> 0</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">          }</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">        },</span></span>
<span class="line"><span style="color:#7C6F64">      },</span></span>
<span class="line"><span style="color:#7C6F64">    },</span></span>
<span class="line"><span style="color:#3C3836">    hit</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">      always</span><span style="color:#7C6F64">:</span><span style="color:#3C3836"> [</span></span>
<span class="line"><span style="color:#7C6F64">        {</span></span>
<span class="line"><span style="color:#3C3836">          target</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">alive</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#B57614">          guard</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> ({</span><span style="color:#076678"> context</span><span style="color:#7C6F64"> })</span><span style="color:#AF3A03"> =></span><span style="color:#076678"> context</span><span style="color:#7C6F64">.</span><span style="color:#076678">hp</span><span style="color:#427B58"> ></span><span style="color:#8F3F71"> 0</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">        },</span></span>
<span class="line"><span style="color:#7C6F64">        {</span></span>
<span class="line"><span style="color:#3C3836">          target</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">dead</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#B57614">          guard</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> ({</span><span style="color:#076678"> context</span><span style="color:#7C6F64"> })</span><span style="color:#AF3A03"> =></span><span style="color:#076678"> context</span><span style="color:#7C6F64">.</span><span style="color:#076678">hp</span><span style="color:#427B58"> ===</span><span style="color:#8F3F71"> 0</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">        },</span></span>
<span class="line"><span style="color:#3C3836">      ]</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">    },</span></span>
<span class="line"><span style="color:#3C3836">    dead</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">      type</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">final</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span></span>
<span class="line"><span style="color:#7C6F64">    },</span></span>
<span class="line"><span style="color:#7C6F64">  },</span></span>
<span class="line"><span style="color:#7C6F64">}</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span></span></code></pre></div><p>Such objects created by the <code>createMachine</code> API function similarly to blueprints—describing how the state machine should work but not performing the work itself. The actual state machines that execute in the program are called <strong>actors</strong>, which are instances created by the state machine factory.</p><p>A working actor for above state machine model looks like this:</p><div><pre class="shiki gruvbox-light-soft" style="background-color:#f2e5bc;color:#3c3836" tabindex="0"><code><span class="line"><span style="color:#AF3A03">const</span><span style="color:#076678"> mobActor</span><span style="color:#427B58"> =</span><span style="color:#B57614"> createActor</span><span style="color:#3C3836">(</span><span style="color:#076678">mobStateMachine</span><span style="color:#7C6F64">,</span><span style="color:#7C6F64"> {</span></span>
<span class="line"><span style="color:#3C3836">  input</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> {</span><span style="color:#3C3836"> maxHp</span><span style="color:#7C6F64">:</span><span style="color:#8F3F71"> 5</span><span style="color:#7C6F64"> },</span></span>
<span class="line"><span style="color:#7C6F64">}</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span></span>
<span class="line"><span style="color:#076678">mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">start</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#076678">console</span><span style="color:#7C6F64">.</span><span style="color:#B57614">log</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">"</span><span style="color:#79740E">mob state:</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#076678"> mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">getSnapshot</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">.</span><span style="color:#076678">value</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span><span style="color:#427B58"> //</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mob state: alive</span><span style="color:#7C6F64">"</span></span>
<span class="line"><span style="color:#076678">console</span><span style="color:#7C6F64">.</span><span style="color:#B57614">log</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">"</span><span style="color:#79740E">mob hp:</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#076678"> mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">getSnapshot</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">.</span><span style="color:#076678">context</span><span style="color:#7C6F64">.</span><span style="color:#076678">hp</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span><span style="color:#427B58"> //</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mob hp: 5</span><span style="color:#7C6F64">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#076678">mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">send</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">{</span><span style="color:#3C3836"> type</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">damage</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#3C3836"> damage</span><span style="color:#7C6F64">:</span><span style="color:#8F3F71"> 3</span><span style="color:#7C6F64"> }</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#076678">console</span><span style="color:#7C6F64">.</span><span style="color:#B57614">log</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">"</span><span style="color:#79740E">mob state:</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#076678"> mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">getSnapshot</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">.</span><span style="color:#076678">value</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span><span style="color:#427B58"> //</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mob state: alive</span><span style="color:#7C6F64">"</span></span>
<span class="line"><span style="color:#076678">console</span><span style="color:#7C6F64">.</span><span style="color:#B57614">log</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">"</span><span style="color:#79740E">mob hp:</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#076678"> mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">getSnapshot</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">.</span><span style="color:#076678">context</span><span style="color:#7C6F64">.</span><span style="color:#076678">hp</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span><span style="color:#427B58"> //</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mob hp: 2</span><span style="color:#7C6F64">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#076678">mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">send</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">{</span><span style="color:#3C3836"> type</span><span style="color:#7C6F64">:</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">damage</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#3C3836"> damage</span><span style="color:#7C6F64">:</span><span style="color:#8F3F71"> 3</span><span style="color:#7C6F64"> }</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#076678">console</span><span style="color:#7C6F64">.</span><span style="color:#B57614">log</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">"</span><span style="color:#79740E">mob state:</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#076678"> mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">getSnapshot</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">.</span><span style="color:#076678">value</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span><span style="color:#427B58"> //</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mob state: dead</span><span style="color:#7C6F64">"</span></span>
<span class="line"><span style="color:#076678">console</span><span style="color:#7C6F64">.</span><span style="color:#B57614">log</span><span style="color:#3C3836">(</span><span style="color:#7C6F64">"</span><span style="color:#79740E">mob hp:</span><span style="color:#7C6F64">"</span><span style="color:#7C6F64">,</span><span style="color:#076678"> mobActor</span><span style="color:#7C6F64">.</span><span style="color:#B57614">getSnapshot</span><span style="color:#3C3836">()</span><span style="color:#7C6F64">.</span><span style="color:#076678">context</span><span style="color:#7C6F64">.</span><span style="color:#076678">hp</span><span style="color:#3C3836">)</span><span style="color:#7C6F64">;</span><span style="color:#427B58"> //</span><span style="color:#7C6F64"> "</span><span style="color:#79740E">mob hp: 0</span><span style="color:#7C6F64">"</span></span></code></pre></div><h1>Robust, precise</h1><p>Writing entity behavior in XState is straightforward, and after getting a grasp of it, fast. The event-based transitions guarantees that all behavior changes are predictable and traceable, which significantly reduces the cognition load during development. The eventless transitions, such as <code>always</code> or <code>after</code>, on the other hand, while demand more awareness, make it simple and natural for describing conversion states.</p><p>XState provides abundant APIs, which enables creating the entire entity behavior in the state machine model, while exposing only the <code>send</code> API, which listens to nothing but the intended events for the current state. The encapsulation of logics makes the state machine robust, which is perhaps my favorite part of XState.</p><h1>Context-rich</h1><p>Finite state machine is the backbone of an entity, but in a real game, an entity is more than just its states. For a killable mob, unless all attacks are instant-deaths such as spikes in <i>Mega Man</i>, a <code>hp</code> property would be necessary.</p><p>XState provides a <strong>contexts</strong> API to integrate properties that changes with state changes or cause state changes, in the state machine itself. This is the integral component that enables the creation of the entire behavior model in XState.</p><h1>Solid hierarchy</h1><p>Some state machines are designed to interact with one another, whether as siblings or parent-child. XState has it covered with the <code>spawn</code> API for vertical hierarchy, or the <code>system</code> API for more general communication among actors. This feature further improves encapsulation by eliminating unnecessary event calls from the user side. It took me a while to comprehend how the actors are supposed to communicate, but the design assures safety and structure.</p><h1>It reacts well</h1><p>It might be easy to take it granted for libraries providing sufficient integration with React, but I really appreciate the native support for React from the <a href="https://stately.ai/docs/xstate-react" target="_blank" rel="noopener noreferrer">@xstate/react</a> package, which makes using XState in React a walk in the park.</p><h1>Conclusion</h1><p>Creating a game with XState was enjoyable, and I plan to continue using it, possibly even for my future projects.</p></article></main><footer class="site-footer_container">Asuka Wang © <!-- -->2025</footer></div></div></div><script>window.__STATIC_PROPS__ = {"blog":{"post":{"metadata":{"title":"Thoughts on Building a Game with XState","description":"After hearing about XState's good reputation for years, I used it to build the prototype for my game. These are my thoughts.","publishedAt":"2025-01-04","pathname":"thoughts-on-building-a-game-with-xstate","category":"note","topic":"game development","language":"en-US","featured":false},"content":[{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"For the prototyping of "},{"type":"link","body":[{"type":"textBody","style":"plain","value":"Project Fiddlesticks"}],"url":"https://grapegummygames.itch.io/project-fiddlesticks"},{"type":"textBody","style":"plain","value":", my latest indie game project, I used "},{"type":"link","body":[{"type":"textBody","style":"plain","value":"React"}],"url":"https://react.dev"},{"type":"textBody","style":"plain","value":" and "},{"type":"link","body":[{"type":"textBody","style":"plain","value":"XState"}],"url":"https://xstate.js.org/"},{"type":"textBody","style":"plain","value":" as the building blocks. Finite state machines are essential components in games, and for a few years I have heard a lot of good things about XState as a finite state machine library; this is my first time using it, and it lived up to its reputation. After finishing the prototype, I decided to write up my thoughts on using XState in game development."}]},{"type":"heading","level":1,"body":[{"type":"textBody","style":"plain","value":"Head first XState"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"Below is an example of a basic state machine that represents the most basic behavior of a mob: it is "},{"type":"textBody","style":"code","value":"alive"},{"type":"textBody","style":"plain","value":" by default, loses "},{"type":"textBody","style":"code","value":"hp"},{"type":"textBody","style":"plain","value":" when taking "},{"type":"textBody","style":"code","value":"damage"},{"type":"textBody","style":"plain","value":", and enters "},{"type":"textBody","style":"code","value":"dead"},{"type":"textBody","style":"plain","value":" state if hp drops to zero."}]},{"type":"code","lang":"ts","body":"const mobStateMachine = setup({\n  types: {\n    context: {} as { hp: number; maxHp: number },\n    input: {} as { maxHp: number },\n    events: {} as { type: \"damage\"; damage: number },\n  },\n}).createMachine({\n  id: \"mobState\",\n  initial: \"alive\",\n  context: ({ input }) =\u003e ({\n    hp: input.maxHp,\n    maxHp: input.maxHp,\n  }),\n  states: {\n    alive: {\n      on: {\n        damage: {\n          target: \"hit\",\n          actions: assign({\n            hp: ({ context, event }) =\u003e Math.max(context.hp - event.damage, 0),\n          }),\n        },\n      },\n    },\n    hit: {\n      always: [\n        {\n          target: \"alive\",\n          guard: ({ context }) =\u003e context.hp \u003e 0,\n        },\n        {\n          target: \"dead\",\n          guard: ({ context }) =\u003e context.hp === 0,\n        },\n      ],\n    },\n    dead: {\n      type: \"final\",\n    },\n  },\n});"},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"Such objects created by the "},{"type":"textBody","style":"code","value":"createMachine"},{"type":"textBody","style":"plain","value":" API function similarly to blueprints—describing how the state machine should work but not performing the work itself. The actual state machines that execute in the program are called "},{"type":"textBody","style":"strong","value":"actors"},{"type":"textBody","style":"plain","value":", which are instances created by the state machine factory."}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"A working actor for above state machine model looks like this:"}]},{"type":"code","lang":"ts","body":"const mobActor = createActor(mobStateMachine, {\n  input: { maxHp: 5 },\n});\nmobActor.start();\n\nconsole.log(\"mob state:\", mobActor.getSnapshot().value); // \"mob state: alive\"\nconsole.log(\"mob hp:\", mobActor.getSnapshot().context.hp); // \"mob hp: 5\"\n\nmobActor.send({ type: \"damage\", damage: 3 });\n\nconsole.log(\"mob state:\", mobActor.getSnapshot().value); // \"mob state: alive\"\nconsole.log(\"mob hp:\", mobActor.getSnapshot().context.hp); // \"mob hp: 2\"\n\nmobActor.send({ type: \"damage\", damage: 3 });\n\nconsole.log(\"mob state:\", mobActor.getSnapshot().value); // \"mob state: dead\"\nconsole.log(\"mob hp:\", mobActor.getSnapshot().context.hp); // \"mob hp: 0\""},{"type":"heading","level":1,"body":[{"type":"textBody","style":"plain","value":"Robust, precise"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"Writing entity behavior in XState is straightforward, and after getting a grasp of it, fast. The event-based transitions guarantees that all behavior changes are predictable and traceable, which significantly reduces the cognition load during development. The eventless transitions, such as "},{"type":"textBody","style":"code","value":"always"},{"type":"textBody","style":"plain","value":" or "},{"type":"textBody","style":"code","value":"after"},{"type":"textBody","style":"plain","value":", on the other hand, while demand more awareness, make it simple and natural for describing conversion states."}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"XState provides abundant APIs, which enables creating the entire entity behavior in the state machine model, while exposing only the "},{"type":"textBody","style":"code","value":"send"},{"type":"textBody","style":"plain","value":" API, which listens to nothing but the intended events for the current state. The encapsulation of logics makes the state machine robust, which is perhaps my favorite part of XState."}]},{"type":"heading","level":1,"body":[{"type":"textBody","style":"plain","value":"Context-rich"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"Finite state machine is the backbone of an entity, but in a real game, an entity is more than just its states. For a killable mob, unless all attacks are instant-deaths such as spikes in "},{"type":"textBody","style":"italic","value":"Mega Man"},{"type":"textBody","style":"plain","value":", a "},{"type":"textBody","style":"code","value":"hp"},{"type":"textBody","style":"plain","value":" property would be necessary."}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"XState provides a "},{"type":"textBody","style":"strong","value":"contexts"},{"type":"textBody","style":"plain","value":" API to integrate properties that changes with state changes or cause state changes, in the state machine itself. This is the integral component that enables the creation of the entire behavior model in XState."}]},{"type":"heading","level":1,"body":[{"type":"textBody","style":"plain","value":"Solid hierarchy"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"Some state machines are designed to interact with one another, whether as siblings or parent-child. XState has it covered with the "},{"type":"textBody","style":"code","value":"spawn"},{"type":"textBody","style":"plain","value":" API for vertical hierarchy, or the "},{"type":"textBody","style":"code","value":"system"},{"type":"textBody","style":"plain","value":" API for more general communication among actors. This feature further improves encapsulation by eliminating unnecessary event calls from the user side. It took me a while to comprehend how the actors are supposed to communicate, but the design assures safety and structure."}]},{"type":"heading","level":1,"body":[{"type":"textBody","style":"plain","value":"It reacts well"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"It might be easy to take it granted for libraries providing sufficient integration with React, but I really appreciate the native support for React from the "},{"type":"link","body":[{"type":"textBody","style":"plain","value":"@xstate/react"}],"url":"https://stately.ai/docs/xstate-react"},{"type":"textBody","style":"plain","value":" package, which makes using XState in React a walk in the park."}]},{"type":"heading","level":1,"body":[{"type":"textBody","style":"plain","value":"Conclusion"}]},{"type":"paragraph","body":[{"type":"textBody","style":"plain","value":"Creating a game with XState was enjoyable, and I plan to continue using it, possibly even for my future projects."}]}]}},"lastUpdated":"2025-07-13"}</script>
  </body>
</html>
